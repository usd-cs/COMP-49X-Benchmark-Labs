import pytest
from model import Model

def test_get_risk_index():
    data = {
    # 20231002
    '2023100200': 54.00, '2023100201': 74.00, '2023100202': 74.00, '2023100203': 74.00,
    '2023100204': 74.00, '2023100205': 74.00, '2023100206': 54.00, '2023100207': 54.00,
    '2023100208': 54.00, '2023100209': 54.00, '2023100210': 54.00, '2023100211': 54.00,
    '2023100212': 54.00, '2023100213': 54.00, '2023100214': 54.00, '2023100215': 54.00,
    '2023100216': 54.00, '2023100217': 54.00, '2023100218': 54.00, '2023100219': 54.00,
    '2023100220': 54.00, '2023100221': 54.00, '2023100222': 54.00, '2023100223': 54.00,

    # 20231003
    '2023100300': 74.00, '2023100301': 74.00, '2023100302': 74.00, '2023100303': 74.00,
    '2023100304': 74.00, '2023100305': 74.00, '2023100306': 54.00, '2023100307': 54.00,
    '2023100308': 54.00, '2023100309': 54.00, '2023100310': 54.00, '2023100311': 54.00,
    '2023100312': 54.00, '2023100313': 54.00, '2023100314': 54.00, '2023100315': 54.00,
    '2023100316': 54.00, '2023100317': 54.00, '2023100318': 54.00, '2023100319': 54.00,
    '2023100320': 54.00, '2023100321': 54.00, '2023100322': 54.00, '2023100323': 54.00,

    # 20231004
    '2023100400': 74.00, '2023100401': 74.00, '2023100402': 74.00, '2023100403': 74.00,
    '2023100404': 74.00, '2023100405': 74.00, '2023100406': 54.00, '2023100407': 54.00,
    '2023100408': 54.00, '2023100409': 54.00, '2023100410': 54.00, '2023100411': 54.00,
    '2023100412': 54.00, '2023100413': 54.00, '2023100414': 54.00, '2023100415': 54.00,
    '2023100416': 54.00, '2023100417': 54.00, '2023100418': 54.00, '2023100419': 54.00,
    '2023100420': 54.00, '2023100421': 54.00, '2023100422': 54.00, '2023100423': 54.00,

    # 20231005
    '2023100500': 74.00, '2023100501': 74.00, '2023100502': 74.00, '2023100503': 74.00,
    '2023100504': 74.00, '2023100505': 74.00, '2023100506': 54.00, '2023100507': 54.00,
    '2023100508': 54.00, '2023100509': 54.00, '2023100510': 54.00, '2023100511': 54.00,
    '2023100512': 54.00, '2023100513': 54.00, '2023100514': 54.00, '2023100515': 54.00,
    '2023100516': 54.00, '2023100517': 54.00, '2023100518': 54.00, '2023100519': 54.00,
    '2023100520': 54.00, '2023100521': 54.00, '2023100522': 54.00, '2023100523': 54.00,

    # 20231006
    '2023100600': 74.00, '2023100601': 74.00, '2023100602': 74.00, '2023100603': 74.00,
    '2023100604': 74.00, '2023100605': 74.00, '2023100606': 54.00, '2023100607': 54.00,
    '2023100608': 54.00, '2023100609': 54.00, '2023100610': 54.00, '2023100611': 54.00,
    '2023100612': 54.00, '2023100613': 54.00, '2023100614': 54.00, '2023100615': 54.00,
    '2023100616': 54.00, '2023100617': 54.00, '2023100618': 54.00, '2023100619': 54.00,
    '2023100620': 54.00, '2023100621': 54.00, '2023100622': 54.00, '2023100623': 54.00
    }
    # from this data start day is 20231003 (from data_test.py, same dataset)

    model_obj_1 = Model(0,0,20231004,20231006, data)
    model_obj_2 = Model(0,0,20231003,20231004, data)
    
    assert model_obj_1.get_risk_index() == 30 # first day adds 20-10, second day adds 20-10, third day adds 20-10, for a total of 30
    assert model_obj_2.get_risk_index() == -1 # not 3 consecutive days so no one to start cycle